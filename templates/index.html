<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Request Server</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='favicon.ico') }}">
</head>
<body>

    <div class="container">
        <h1>CREATE NEW WORLD</h1>
        
        <form action="/request-server" method="POST">
            
            <div class="form-group">
                <label>Email</label>
                <input type="text" name="email" placeholder="email@example.com" required maxlength="50">
            </div>

            <div class="form-group">
                <label>Server Name</label>
                <input type="text" 
                    name="servername" 
                    placeholder="myWorld"
                    pattern="[a-zA-Z0-9]+" 
                    title="Only letters and numbers are allowed. No spaces or symbols." 
                    required
                    maxlength="20">
            </div>

             <div class="form-group">
                <label>Gamemode</label>
                <select name="gamemode">
                    <option value="survival">Survival</option>
                    <option value="creative">Creative</option>
                </select>
            </div>

            <div class="form-group">
                <label>World Seed (Optional)</label>
                <input type="text" 
                    name="seed" 
                    placeholder="Leave blank for random" 
                    pattern="[a-zA-Z0-9]+" 
                    title="Only letters and numbers are allowed. No spaces or symbols." 
                    maxlength="20">
            </div>

            <div class="form-group">
                <label>Difficulty</label>
                <select name="difficulty">
                    <option value="peaceful">Peaceful</option>
                    <option value="easy">Easy</option>
                    <option value="normal" selected>Normal</option>
                    <option value="hard">Hard</option>
                </select>
            </div>

            <div class="form-group">
                <label>
                    <input type="checkbox" name="whitelist_checkbox" id="wl_toggle"> Enable Whitelist?
                </label>

                <div id="username_field" style="display:none;">
                    <input type="text" name="mc_username" placeholder="Your Minecraft Username" maxlength="16">
                </div>
            </div>
            
            <button type="submit" class="mc-btn">REQUEST SERVER</button>
        </form>

        <div style="text-align:center; margin-top:15px;">
            <a href="/admin" style="color: #555; text-decoration: none;">[Admin Login]</a>
        </div>
    </div>


    {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
        {% for category, message in messages %}
        <div class="mc-alert mc-alert-{{ category }}">
            <div class="mc-alert-icon">
                {% if category == 'success' %} ✅ {% else %} ❌ {% endif %}
            </div>
            <div class="mc-alert-text">
                <strong>{{ 'SUCCESS!' if category == 'success' else 'SYSTEM ERROR' }}</strong><br>
                {{ message }}
            </div>
        </div>
        {% endfor %}
    {% endif %}
    {% endwith %}

    <style>
        /* Minecraft Styled Alerts */
        .mc-alert {
            background: #212121;
            border: 4px solid #000;
            padding: 15px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            box-shadow: inset -4px -4px 0px #424242;
            font-family: 'Minecraftia', Courier, monospace;
        }
        .mc-alert-success { border-color: #55FF55; color: #55FF55; }
        .mc-alert-danger { border-color: #FF5555; color: #FF5555; }
        
        .mc-alert-icon { font-size: 24px; margin-right: 15px; }
        .mc-alert-text { line-height: 1.2; }
    </style>    


    {% if error %}
        <div style="background: #ff5555; color: white; padding: 10px; border: 2px solid #aa0000; margin-bottom: 20px;">
            ERROR: That server name is already in use!
        </div>
    {% endif %}

    <script>
        document.getElementById('wl_toggle').onchange = function() {
        document.getElementById('username_field').style.display = this.checked ? 'block' : 'none';
    };
        // Find any mc-alert and hide it after 5 seconds
        setTimeout(() => {
            const alerts = document.querySelectorAll('.mc-alert');
            alerts.forEach(alert => {
                alert.style.transition = "opacity 0.5s ease";
                alert.style.opacity = "0";
                setTimeout(() => alert.remove(), 500);
            });
        }, 5000);
    </script>
    
</body>
</html>
